!function(t){t.fn.reactionCounter=function(a){function e(a,e){var o=a.substr(a.lastIndexOf("/")+1)
return t.ajax({url:"https://graph.facebook.com/v2.9/"+o+"?access_token="+e,method:"GET",dataType:"json",async:!1}).done(function(t){n=t.id}).fail(function(t){s.postID=null,console.log(t.status+" - "+t.responseJSON.error.message)}),n}function o(){var a=r.map(function(t){var a=t
return"reactions.type("+t.toUpperCase()+").limit(0).summary(total_count).as("+a+")"})
a.push("reactions.limit(0).summary(total_count).as(total)"),t.ajax({url:"https://graph.facebook.com/v2.9/?ids="+s.postID+"&fields="+a.join(",")+"&access_token="+l,method:"GET",dataType:"json"}).done(function(a){var e=[],o=0
t.each(a[s.postID],function(t,a){"total"!=t&&"id"!=t&&(o+=this.summary.total_count)}),t.each(i,function(n,r){var c=t(this).data("reaction"),i=a[s.postID][c].summary.total_count
t(this).find(".fbr-counter").text(s.defaultCount+i),t(this).attr("data-reaction-total",i).attr("data-reaction-percent",i/o*100),e.push(c+" ("+i+" ["+(i/o*100).toFixed(1)+"%])")}),"selected"===s.totalType?(c.attr("data-reaction-total",o),t(s.totalSelector).text(o)):"all"===s.totalType&&(c.attr("data-reaction-total",a[s.postID].total.summary.total_count),t(s.totalSelector).text(a[s.postID].total.summary.total_count)),!0===s.showOutput&&(e.push("total("+o+")"),console.log("Data: "+e.join(" | ")))}).fail(function(t){console.log(t.status+" - "+t.responseJSON.error.message)})}var n,s=t.extend({pageURL:"",clientID:"",secretID:"",postID:"",refreshTime:5,defaultCount:0,showOutput:!0,totalSelector:".fbr-total",totalType:"selected"},a),r=[],c=this,i=this.find("[data-reaction]").not("p"),l=function(a,e){var o={client_id:a,client_secret:e,grant_type:"client_credentials"}
return t.ajax({url:"https://graph.facebook.com/oauth/access_token?"+t.param(o),type:"GET",dataType:"json",async:!1}).done(function(t){l=t.access_token}).fail(function(t){console.log(t.status+" - "+t.responseJSON.error.message)}),l}(s.clientID,s.clientSecret);(n=e(s.pageURL,l))&&(s.postID=e(s.pageURL,l)+"_"+s.postID),l&&null!=s.postID&&function(){t.each(i,function(a,e){r.push(t(this).data("reaction"))
var o=t("<span>",{class:"fbr-counter"})
"append"===s.appendPrepend?t(this).append(o):t(this).prepend(o)}),setInterval(o,1e3*parseInt(s.refreshTime)),o()}()}}(jQuery)
